<?xml version="1.0" encoding="UTF-8"?>
<authdriver id="authfront.otp" enabled="false" name="authfront.otp" label="CONF_MESSAGE[Authentication One-time-password]" description="CONF_MESSAGE[Use Google Authenticator, Yubikey or standard password to authenticate users.]" mixins="authdriver_commons"  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="file:../core.ajaxplorer/ajxp_registry.xsd">
    <plugin_info>
        <plugin_author>Janos Milus</plugin_author>
        <plugin_version>0.1</plugin_version>
        <core_relation packaged="false" tested_version="5.3.2"/>
    </plugin_info>
    <client_settings>
        <resources>
            <i18n namespace="authfront.otp" path="plugins/authfront.otp/i18n"/>
        </resources>
    </client_settings>
    <server_settings>
        <global_param name="ORDER" type="integer" label="Order" description="Order this plugin with other auth frontends" default="13" mandatory="true"/>
        <global_param name="CREATE_USER"  type="boolean" label="Create User"
                      description="Automatically create user if it does not already exists" default="true"/>
        <global_param name="PROTOCOL_TYPE" group="CONF_MESSAGE[General]" type="select"
                      choices="session_only|Sessions Only"
                      label="Protocol Type" description="Enable/disable automatically based on the protocol used" default="session_only" mandatory="true" />

        <global_param  expose="true" name="MODIFY_LOGIN_SCREEN" group="CONF_MESSAGE[General]" type="boolean" label="Modify login page"
                       description="Login page will be modified " default="true" editable="false"/>

        <global_param name="USERS_FILEPATH" type="string" label="CONF_MESSAGE[Users]" description="CONF_MESSAGE[The users list]" mandatory="true"/>
        <global_param name="YUBICO_SECRET_KEY" type="string" label="CONF_MESSAGE[Yubico Secret Key]" description="CONF_MESSAGE[Yubico secret key attached to your account]" mandatory="false"/>
        <global_param name="YUBICO_CLIENT_ID" type="string" label="CONF_MESSAGE[Yubico Client ID]" description="CONF_MESSAGE[Yubico client id attached to your account]" mandatory="false"/>
        <global_param name="GOOGLE" type="string" label="CONF_MESSAGE[Google Authenticator]"  description="CONF_MESSAGE[Google Authenticator Secret]" mandatory="false"/>
        <global_param name="GOOGLE_LAST" type="integer" label="CONF_MESSAGE[Google Authenticator Last]"  description="CONF_MESSAGE[Google Authenticator replay protection, do not edit]" mandatory="false"/>
        <global_param name="YUBIKEY1" type="string" label="CONF_MESSAGE[YubiKey 1]"  description="CONF_MESSAGE[YubiKey 1]" mandatory="false"/>
        <global_param name="YUBIKEY2" type="string" label="CONF_MESSAGE[YubiKey 2]"  description="CONF_MESSAGE[YubiKey 2]" mandatory="false"/>
        <global_param name="ADDITIONAL_ROLE" group="General" type="string" label="Additional roles for user logged in by CAS" default="" description="Additional roles for user logged in by CAS"/>
    </server_settings>
    <class_definition filename="plugins/authfront.otp/class.OtpAuthFrontend.php" classname="OtpAuthFrontend"/>
    <registry_contributions>
        <external_file filename="plugins/core.auth/standard_auth_actions.xml" include="actions/*" exclude=""/>
    </registry_contributions>
</authdriver>