<?xml version="1.0" encoding="UTF-8"?>
<ajxp_plugin id="antivirus" label="CONF_MESSAGE[Antivirus]" description="CONF_MESSAGE[antivirus plugin adaptor]" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="file:../core.ajaxplorer/ajxp_registry.xsd">
	<!-- langues -->
    <resources>
        <i18n namespace="antivirus" path="plugins/user-defined.antivirus/i18n"/>
    </resources>
	
	<!-- fichier class du plugin -->
	<class_definition filename="plugins/user-defined.antivirus/class.scan.php" classname="scan"/>

	<!-- information sur le plugin -->
	<plugin_info>
		<plugin_author>Sylvain Letreguilly</plugin_author>
		<plugin_uri>no</plugin_uri>
		<plugin_version>0.5</plugin_version>
	        <core_relation packaged="false" tested_version="4.3.3"/>
	</plugin_info>

	<!-- parametre du plugin -->
	<server_settings>
		<global_param group="CONF_MESSAGE[antivirus]" name="COMMAND" type="string" label="CONF_MESSAGE[antivirus command]" description="CONF_MESSAGE[Entrer here the antivirus command for the system. Use $FILE for the file path]" mandatory="false" default="clamdscan --remove=yes $FILE"/>
		<global_param group="CONF_MESSAGE[antivirus]" name="EXT" type="textarea" label="CONF_MESSAGE[File extension to scan]" description="CONF_MESSAGE[List of all scan extension. Il the list begin by */ all extention will be scanned execpt exetension in the list]" mandatory="false" default="*/"/>
		<global_param group="CONF_MESSAGE[antivirus]" name="SIZE" type="string" label="CONF_MESSAGE[max file size]" description="CONF_MESSAGE[max size of file scan immediatly after upload]" mandatory="false" default="12G"/>
		<global_param group="CONF_MESSAGE[Generate a trace file unscanned]" name="TRACE" type="boolean" label="CONF_MESSAGE[Trace enabled]" description="CONF_MESSAGE[It is possible to write the path of the file to be scanned in a file rather than the scanner immediately, this option not be useful if you want to use a different computer than the web server to do the scans for example.]" default="false"/>
		<global_param group="CONF_MESSAGE[Generate a trace file unscanned]" name="PATH" type="string" label="CONF_MESSAGE[Folder of output file]" description="CONF_MESSAGE[directory path or AjaXplorer deposit files containing only the actual path of the file upload]" mandatory="false" default="/var/www/trace"/>
	</server_settings>
	
	
	<!-- dÃ©claration des hooks -->
	<registry_contributions>
		<hooks>
			<serverCallback hookName="node.change" methodName="scan_file"/>
		</hooks>
	</registry_contributions>
</ajxp_plugin>
